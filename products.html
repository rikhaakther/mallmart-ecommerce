<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MallMart — Products</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg bg-white sticky-top border-bottom">
    <div class="container">
      <a class="navbar-brand fw-bold brand" href="index.html">
        <span class="brand-dot"></span> MallMart
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="nav">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link active" href="products.html">Products</a></li>
          <li class="nav-item"><a class="nav-link" href="cart.html">Cart</a></li>
          <li class="nav-item"><a class="nav-link" href="checkout.html">Checkout</a></li>
        </ul>

        <div class="d-flex gap-2 align-items-center">
          <div class="input-group searchbox d-none d-lg-flex" style="max-width: 360px;">
            <span class="input-group-text bg-white border-end-0"><i class="bi bi-search"></i></span>
            <input id="searchInputTop" class="form-control border-start-0" type="search" placeholder="Search products...">
          </div>

          <a class="btn btn-outline-dark iconbtn position-relative" href="cart.html" title="Cart">
            <i class="bi bi-bag"></i>
            <span id="cartBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
              0
            </span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="py-4">
    <div class="container">
      <div class="d-flex flex-wrap gap-2 align-items-end justify-content-between">
        <div>
          <h1 class="fw-bold mb-1">Products</h1>
          <p class="text-muted mb-0">Search, filter, and add products to cart.</p>
        </div>

        <div class="d-flex gap-2 align-items-center">
          <select id="sortSelect" class="form-select" style="max-width: 240px;">
            <option value="recommended" selected>Sort: Recommended</option>
            <option value="low">Price: Low to High</option>
            <option value="high">Price: High to Low</option>
            <option value="name">Name: A → Z</option>
          </select>
        </div>
      </div>

      <!-- Category Filter Buttons -->
      <div class="mt-3 d-flex flex-wrap gap-2">
        <button class="btn btn-dark btn-sm filter-btn" data-category="all">All</button>
        <button class="btn btn-outline-dark btn-sm filter-btn" data-category="Electronics">Electronics</button>
        <button class="btn btn-outline-dark btn-sm filter-btn" data-category="Fashion">Fashion</button>
        <button class="btn btn-outline-dark btn-sm filter-btn" data-category="Home">Home</button>
        <button class="btn btn-outline-dark btn-sm filter-btn" data-category="Groceries">Groceries</button>

        <div class="ms-auto d-flex gap-2 flex-wrap">
          <div class="input-group searchbox d-lg-none" style="max-width: 420px;">
            <span class="input-group-text bg-white border-end-0"><i class="bi bi-search"></i></span>
            <input id="searchInputMobile" class="form-control border-start-0" type="search" placeholder="Search products...">
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="pb-5">
    <div class="container">
      <div class="row g-3" id="productGrid">
        <!-- Cards injected by JS -->
      </div>

      <!-- Empty state -->
      <div id="emptyState" class="text-center text-muted py-5 d-none">
        <div class="fs-4 fw-bold mb-1">No products found</div>
        <div>Try another search or category.</div>
      </div>
    </div>
  </main>

  <!-- Quick View Modal -->
  <div class="modal fade" id="quickViewModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content rounded-4">
        <div class="modal-body p-4">
          <div class="d-flex justify-content-between align-items-start mb-2">
            <div>
              <div id="qvCategory" class="small text-muted"></div>
              <h3 id="qvTitle" class="fw-bold mb-1"></h3>
              <div class="small text-muted">Demo quick view</div>
            </div>
            <button class="btn btn-outline-dark btn-sm" data-bs-dismiss="modal"><i class="bi bi-x-lg"></i></button>
          </div>

          <div class="row g-3 align-items-center">
            <div class="col-md-6">
              <div class="product-img rounded-4" style="height: 260px;">
                <div class="img-placeholder">Product Image</div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-end gap-2 mb-2">
                <div class="fw-bold fs-3">৳<span id="qvPrice"></span></div>
                <div class="text-muted text-decoration-line-through" id="qvOldPriceWrap">
                  ৳<span id="qvOldPrice"></span>
                </div>
              </div>
              <p class="text-muted mb-3">
                Premium quality product for daily use. (Demo description — you can replace later)
              </p>

              <div class="d-flex gap-2 flex-wrap">
                <a id="qvDetailsLink" class="btn btn-outline-dark" href="product-details.html">
                  View Details
                </a>
                <button id="qvAddBtn" class="btn btn-dark">
                  <i class="bi bi-bag-plus me-1"></i> Add to Cart
                </button>
                <a class="btn btn-outline-dark" href="cart.html">Go to Cart</a>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // ---------- Demo Product Data ---------
    const PRODUCTS = [

  { id: 1, title: "Wireless Headphones", category: "Electronics", price: 2799, oldPrice: 3499, rating: 4.6, badge: "-20%" },

  { id: 7, title: "Bluetooth Speaker", category: "Electronics", price: 1899, oldPrice: 2299, rating: 4.3, badge: "Hot" },
  { id: 8, title: "Gaming Mouse RGB", category: "Electronics", price: 1499, oldPrice: null, rating: 4.5, badge: "New" },
  { id: 9, title: "4K Smart TV 43 inch", category: "Electronics", price: 38999, oldPrice: 42999, rating: 4.8, badge: "-10%" },

  { id: 2, title: "Casual Sneakers", category: "Fashion", price: 1999, oldPrice: null, rating: 4.4, badge: "New" },
  { id: 3, title: "Air Fryer 3.5L", category: "Home", price: 5499, oldPrice: null, rating: 4.7, badge: "Hot" },
  { id: 4, title: "Organic Honey 500g", category: "Groceries", price: 699, oldPrice: null, rating: 4.5, badge: "Best" },
  { id: 5, title: "Smart Watch", category: "Electronics", price: 2599, oldPrice: 2999, rating: 4.3, badge: "-10%" },
  { id: 6, title: "Backpack", category: "Fashion", price: 1299, oldPrice: null, rating: 4.2, badge: "New" },

  { id: 10, title: "Men's Denim Jacket", category: "Fashion", price: 2499, oldPrice: null, rating: 4.2, badge: "New" },
  { id: 11, title: "Women's Handbag", category: "Fashion", price: 1799, oldPrice: 2199, rating: 4.4, badge: "-15%" },
  { id: 12, title: "Running Shoes", category: "Fashion", price: 3299, oldPrice: null, rating: 4.6, badge: "Best" },

  { id: 13, title: "Basmati Rice 5kg", category: "Groceries", price: 699, oldPrice: null, rating: 4.5, badge: "Best" },
  { id: 14, title: "Olive Oil 1L", category: "Groceries", price: 1199, oldPrice: 1399, rating: 4.3, badge: "-10%" },
  { id: 15, title: "Green Tea Pack", category: "Groceries", price: 399, oldPrice: null, rating: 4.2, badge: "New" }

];


    // ---------- Cart helpers (localStorage) ----------
    const CART_KEY = "mallmart_cart";

    function getCart() {
      return JSON.parse(localStorage.getItem(CART_KEY) || "[]");
    }
    function setCart(cart) {
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
      updateCartBadge();
    }
    function updateCartBadge() {
      const cart = getCart();
      const count = cart.reduce((sum, item) => sum + item.qty, 0);
      document.getElementById("cartBadge").textContent = count;
    }
    function addToCart(productId) {
      const cart = getCart();
      const found = cart.find(i => i.id === productId);
      if (found) found.qty += 1;
      else cart.push({ id: productId, qty: 1 });

      setCart(cart);
    }

    // ---------- Render ----------
    const grid = document.getElementById("productGrid");
    const emptyState = document.getElementById("emptyState");

    let activeCategory = "all";

    function productCard(p) {
      const badgeClass =
        p.badge?.includes("-") ? "bg-danger" :
        p.badge === "Hot" ? "bg-warning text-dark" :
        p.badge === "Best" ? "bg-dark" :
        "bg-success";

      return `
      <div class="col-12 col-sm-6 col-lg-4">
        <div class="product-card h-100">
          <div class="product-img">
            ${p.badge ? `<span class="badge ${badgeClass}">${p.badge}</span>` : ""}
            <button class="btn btn-light btn-sm heart" type="button" title="Wishlist">
              <i class="bi bi-heart"></i>
            </button>
            <div class="img-placeholder">Product Image</div>
          </div>
          <div class="p-3">
            <div class="small text-muted">${p.category}</div>
            <a class="fw-semibold text-decoration-none text-dark d-block mb-1" href="product-details.html">
              ${p.title}
            </a>
            <div class="rating small mb-2">
              <i class="bi bi-star-fill"></i> ${p.rating.toFixed(1)}
              <span class="text-muted">(demo)</span>
            </div>

            <div class="d-flex align-items-center justify-content-between">
              <div>
                <div class="price">৳${p.price.toLocaleString()}</div>
                ${p.oldPrice ? `<div class="small text-muted text-decoration-line-through">৳${p.oldPrice.toLocaleString()}</div>` : `<div class="small text-muted">&nbsp;</div>`}
              </div>

              <div class="d-flex gap-2">
                <button class="btn btn-outline-dark btn-sm" type="button"
                  data-action="quick" data-id="${p.id}">
                  Quick View
                </button>
                <button class="btn btn-dark btn-sm" type="button"
                  data-action="add" data-id="${p.id}">
                  <i class="bi bi-bag-plus me-1"></i> Add
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>`;
    }

    function applyFilters() {
      const searchTop = document.getElementById("searchInputTop").value.trim().toLowerCase();
      const searchMobile = document.getElementById("searchInputMobile").value.trim().toLowerCase();
      const q = (searchTop || searchMobile);

      let list = PRODUCTS.slice();

      // category filter
      if (activeCategory !== "all") {
        list = list.filter(p => p.category === activeCategory);
      }

      // search filter
      if (q) {
        list = list.filter(p => p.title.toLowerCase().includes(q));
      }

      // sorting
      const sort = document.getElementById("sortSelect").value;
      if (sort === "low") list.sort((a,b) => a.price - b.price);
      if (sort === "high") list.sort((a,b) => b.price - a.price);
      if (sort === "name") list.sort((a,b) => a.title.localeCompare(b.title));

      // render
      grid.innerHTML = list.map(productCard).join("");
      emptyState.classList.toggle("d-none", list.length !== 0);
    }

    // ---------- Events ----------
    document.getElementById("sortSelect").addEventListener("change", applyFilters);

    document.getElementById("searchInputTop").addEventListener("input", () => {
      document.getElementById("searchInputMobile").value = document.getElementById("searchInputTop").value;
      applyFilters();
    });

    document.getElementById("searchInputMobile").addEventListener("input", () => {
      document.getElementById("searchInputTop").value = document.getElementById("searchInputMobile").value;
      applyFilters();
    });

    document.querySelectorAll(".filter-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("btn-dark"));
        document.querySelectorAll(".filter-btn").forEach(b => b.classList.add("btn-outline-dark"));

        btn.classList.remove("btn-outline-dark");
        btn.classList.add("btn-dark");
        activeCategory = btn.dataset.category;
        applyFilters();
      });
    });

    // Delegate clicks for Add & Quick View
    const qvModal = new bootstrap.Modal(document.getElementById("quickViewModal"));
    let qvCurrentId = null;

    document.addEventListener("click", (e) => {
      const el = e.target.closest("[data-action]");
      if (!el) return;

      const action = el.dataset.action;
      const id = parseInt(el.dataset.id, 10);
      const p = PRODUCTS.find(x => x.id === id);
      if (!p) return;

      if (action === "add") {
        addToCart(id);
      }

      if (action === "quick") {
        qvCurrentId = id;
        document.getElementById("qvCategory").textContent = p.category;
        document.getElementById("qvTitle").textContent = p.title;
        document.getElementById("qvPrice").textContent = p.price.toLocaleString();

        const oldWrap = document.getElementById("qvOldPriceWrap");
        if (p.oldPrice) {
          oldWrap.style.display = "block";
          document.getElementById("qvOldPrice").textContent = p.oldPrice.toLocaleString();
        } else {
          oldWrap.style.display = "none";
        }

        qvModal.show();
      }
    });

    document.getElementById("qvAddBtn").addEventListener("click", () => {
      if (qvCurrentId) addToCart(qvCurrentId);
    });

    // ---------- Init ----------
    updateCartBadge();
    applyFilters();
  </script>
</body>
</html>
